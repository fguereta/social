{% extends "ABME/Paciente/menupaciente.html" %}

{% block contenido_paciente %}




{% if solicitud_enviado %}
{% for elemento in solicitud_enviado %}

{% if refrescar %}

<script type="text/javascript" charset="utf-8" async defer>

window.location.href = "/aplicacion/fichasolicitud/{{refrescar}}/";


</script>

{% endif %}



{% ifequal elemento.estado_aprobacion "CANCELADO" %}




<style type="text/css" media="screen">
 
 .panel > .panel-heading {
    background-image: none;
    background-color: #FA5858;
    color: #000000;
}


 .panel > .panel-body {
    
    
  padding: 15px;
  margin-bottom: 20px;
  background-color: #ffffff;
  border: 1px solid #dddddd;
  border-radius: 4px;
  -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05); }
</style>


<script  type="text/javascript" charset="utf-8" async defer>
	
$('#paciente_nombre').hide(); 
$('#estado_cancelada').show();
$('#modificar').hide(); 
$('#eliminar').hide();
$('#derivaciones').hide(); 
$( "p" ).hide();


</script>

{% endifequal %}

{% ifequal elemento.estado_aprobacion "APROBADO" %}




<style type="text/css" media="screen">
 
 .panel > .panel-heading {
    background-image: none;
    background-color: #81F781;
    color: #000000;
}


 .panel > .panel-body {
    
    
  padding: 15px;
  margin-bottom: 20px;
  background-color: #000000;
  border: 1px solid #dddddd;
  border-radius: 4px;
  -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05); }
</style>


<script  type="text/javascript" charset="utf-8" async defer>
	
$('#paciente_nombre').hide(); 
$('#estado_aprobado').show();
$('#modificar').hide(); 
$('#eliminar').hide();
$('#derivaciones').hide(); 



</script>

{% endifequal %}
{% ifequal elemento.estado_aprobacion "ENPROGRESO" %}




<style type="text/css" media="screen">
 
 .panel > .panel-heading {
    background-image: none;
    background-color: #F3F781;
    color: #000000;
}


 .panel > .panel-body {
    
    
  padding: 15px;
  margin-bottom: 20px;
  background-color: #000000;
  border: 1px solid #dddddd;
  border-radius: 4px;
  -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05); }
</style>


<script  type="text/javascript" charset="utf-8" async defer>
	
$('#paciente_nombre').hide(); 
$('#estado_enproceso').show();
$('#modificar').hide(); 
$('#eliminar').hide();
$('#derivaciones').hide(); 



</script>

{% endifequal %}

{% ifequal elemento.estado_aprobacion "PARCIAL" %}




<style type="text/css" media="screen">
 
 .panel > .panel-heading {
    background-image: none;
    background-color: #FAAC58;
    color: #000000;
}


 .panel > .panel-body {
    
    
  padding: 15px;
  margin-bottom: 20px;
  background-color: #ffffff;
  border: 1px solid #dddddd;
  border-radius: 4px;
  -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05); }
</style>


<script  type="text/javascript" charset="utf-8" async defer>
	
$('#paciente_nombre').hide(); 
$('#estado_parcial').show();
$('#modificar').hide(); 
$('#eliminar').hide();
$('#derivaciones').hide(); 



</script>

{% endifequal %}

{% ifequal elemento.estado_aprobacion "ENTREGADO" %}




<style type="text/css" media="screen">
 
 .panel > .panel-heading {
    background-image: none;
    background-color: #01A9DB;
    color: #000000;
}


 .panel > .panel-body {
    
    
  padding: 15px;
  margin-bottom: 20px;
  background-color: #ffffff;
  border: 1px solid #dddddd;
  border-radius: 4px;
  -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05); }
</style>


<script  type="text/javascript" charset="utf-8" async defer>
	
$('#paciente_nombre').hide(); 
$('#estado_entregado').show();
$('#modificar').hide(); 
$('#eliminar').hide();
$('#derivaciones').hide(); 



</script>

{% endifequal %}




<div class='panel-body'>
          
        <form  method="POST" enctype="multipart/form-data" class="form-horizontal">


            


        <div class="form-group">
          <label for="paciente" class="control-label col-md-2  ">Solicitud N°</label> 
          <div class="col-md-5">

            {% for elemento in solicitud_enviado %}
            <input class="form-control" id="idsolicitud4" name="idsolicitud4" type="hidden" value="{{elemento.solicitud_id}}"/>
            <input class="form-control"  type="text" readonly="readonly" value="{{elemento.id}}"/>
            {% endfor %}
          </div>
        </div>
        <div class="form-group">
          <label for="paciente" class="control-label col-md-2 ">Solicitante:</label> 
          <div class="col-md-5">
            {% for elemento in solicitud_enviado %}
            <input class="form-control" id="id_paciente" name="id_paciente" type="hidden" value="{{elemento.paciente.id}}"/>
            <input class="form-control"  type="text" readonly="readonly" value="{{elemento.paciente.apellido}}, {{elemento.paciente.nombre}}. DNI: {{elemento.paciente.dni}}"/>
            {% endfor %}
          </div>
        </div>
       

        <div class="form-group">
          <label for="paciente" class="control-label  col-md-2 ">Historia Clinica:</label> 
          <div class="col-md-5">
            
            {% for elemento in solicitud_enviado %}
            
            <input class="form-control"  type="text" readonly="readonly" value="{{elemento.paciente.historiaclinica}} " readonly />
            {% endfor %}
            
          </div>
        </div>


        


        <div class="form-group">
          <label for="paciente" class="control-label  col-md-2 ">Obra Social:</label> 
          <div class="col-md-5">
            
            {% for elemento in solicitud_enviado %}
            
            <input class="form-control"  type="text" readonly="readonly" value="{{elemento.paciente.osocial}}" readonly />
            {% endfor %}
            
          </div>
        </div>
        <br>
      
          <legend ><div class=" col-md-offset-4">Detalles de la solicitud</div></legend>
        
        
        <br>

        <div class="form-group">
          <label for="paciente" class="control-label  col-md-3 ">Medico:</label> 
          <div class="col-md-5">
            
            {% for elemento in solicitud_enviado %}
            
            <input class="form-control"  type="text" readonly="readonly" value="{{elemento.medico.apellido}}, {{elemento.medico.nombre}}" readonly />
            {% endfor %}
            
          </div>
        </div>


        <div class="form-group">
          <label for="paciente" class="control-label  col-md-3 ">Nombre de generico:</label> 
          <div class="col-md-5">
            
            {% for elemento in solicitud_enviado %}
            
            <input class="form-control"  type="text" readonly="readonly" value="{{elemento.remedio.generico}}" readonly />
            {% endfor %}
            
          </div>
        </div>

        

        <div class="form-group">
          <label for="paciente" class="control-label  col-md-3 ">Dosis:</label> 
          <div class="col-md-5">
            {% for elemento in solicitud_enviado %}
            <input class="form-control" readonly="readonly" type="text" value="{{elemento.dosis}}" " />
            {% endfor %}
          </div>
        </div>


        
        

   

		{% ifequal elemento.estado_aprobacion "CANCELADO"  %} 
      <div class="form-group">

         <legend ><div class=" col-md-offset-4"  style=' font-size:25px;'><font color="red" SIZE=5 >Motivo de Cancelación</div></legend>
          <div class="form-group">
          <div class="col-md-offset-3">
          {% for elemento in solicitud_enviado %}
            
          <textarea class="form-control" type='text' cols="40" id="comparcial" style='width:468px;height: 126px;' name="comparcial" rows="10" readonly>{{elemento.observaciones}}</textarea>
          {% endfor %}
          </div>
          </div>
        </div>

      <br>
      <br>
      <br>

    {% else %}


      


      {% ifequal elemento.estado_aprobacion "ENTREGADO"  %} 
    
      
      <div class="form-group">
          <label for="comcancelado" class="control-label col-md-2 col-md-offset-1">Observaciones:</label> 
          <div class="col-md-5">
          {% for elemento in solicitud_enviado %}
            
          <textarea class="form-control" type='text' cols="40" id="comparcial" style='width:427px;height: 102px;' name="comparcial" rows="10" readonly>{{elemento.observaciones}}</textarea>
          {% endfor %}
          </div>
        </div>

      


      {% else %}


      <div class="form-group">
          <label for="comcancelado" class="control-label col-md-2 col-md-offset-1">Observaciones:</label> 
          <div class="col-md-5">
          {% for elemento in solicitud_enviado %}
            
          <textarea class="form-control" type='text' cols="40" id="comparcial" style='width:427px;height: 102px;' name="comparcial" rows="10" readonly>{{elemento.observaciones}}</textarea>
          {% endfor %}
          </div>
        </div>

        <br>
        <br>

          <p id='a' name='a'>
            <div class="row" >
      
              <div id='exportarpdf' class="col-xs-6 col-md-4 col-md-offset-2" style=' font-size:25px;'  ><a href="/aplicacion/pdf_solicitud/{{elemento.id}}/"><input  class='btn-lg btn-primary' type="button" value='Exportar PDF'/></a></div>
              <div class="col-xs-6 col-md-4" style=' font-size:25px;' ><input class='btn-lg btn-primary' name='cambiar_estado' id='cambiar_estado' type="button"  value='Cambiar Estado'/></div>
            </div>

          </p>
    
      {% endifequal %}




		

		
		
		{% endifequal %}

    
        
       


       



        
        </form>
        </div>
  <br>
 


<br>

</div>
</div>

<br><br>



					

	





<script type="text/javascript" charset="utf-8" async defer>
              
    $("input[id=cambiar_estado]").click(function () {
      
   		alertify.set({ labels: {
            ok     : "Confirmar",
            cancel : "Cancelar"
            } });
        // confirm dialog
        
        alertify.confirm("{% ifequal elemento.estado_aprobacion 'ENPROGRESO' %}<div class='container '><div class='form-group'><div class='col-xs-3 col-md-offset-1'><div class='form-group'> SELECCIONE NUEVO ESTADO <br></br> <select class='form-control smallselect' id='nuevoestado' name='nuevoestado' ><option value='CANCELADO'>CANCELAR</option><option value='APROBADO'>APROBADO</option></select></div></div></div></div>{% endifequal %}{% ifequal elemento.estado_aprobacion 'APROBADO' %}<div class='container '><div class='form-group'><div class='col-xs-3 col-md-offset-1'><div class='form-group'> SELECCIONE NUEVO ESTADO <br></br> <select class='form-control smallselect' id='nuevoestado' name='nuevoestado' ><option value='CANCELADO'>CANCELAR</option></select></div></div></div></div>{% endifequal %}{% ifequal elemento.estado_aprobacion 'PARCIAL' %}<div class='container '><div class='form-group'><div class='col-xs-3 col-md-offset-1'><div class='form-group'> SELECCIONE NUEVO ESTADO <br></br> <select class='form-control smallselect' id='nuevoestado' name='nuevoestado' ><option value='CANCELADO'>CANCELAR</option></select></div></div></div></div>{% endifequal %}", function (e) {
    
            if (e) {
            	nuevo_estado=$('select[name=nuevoestado]').val();

            		if(nuevo_estado=="CANCELADO"){

            			 alertify.confirm("Una vez CANCELADA esta solicitud quedara anulada, ¿Desea cancelar la solicitud?", function (e) {
    					     if (e) {
    						          window.location.href = "/aplicacion/solicitudcancelada/{{elemento.id}}/";
        					
    					       } else {
        					   // user clicked "cancel"
    					     }
						      });

            		}else{

                  

                    

            				$( "#idsolicitud" ).val('{{elemento.id}}');

                             var nuevoestado = $("#nuevoestado").val();

                             $( "#nuevo_estado" ).val(nuevoestado);
                            
                             $("#aprobado").submit();


            		}
            	


            } else {
                
                
                
                }});

			});

</script>

{% endfor %}

<form  id='aprobado' method='POST' action='/aplicacion/cambiarestado/' enctype='multipart/form-data' class='form-horizontal'>{% csrf_token %}
<input class='form-control' id='idsolicitud' name='idsolicitud'  type="hidden" value=''/>
<input class='form-control' id='nuevo_estado' name='nuevo_estado' type="hidden" value=''/>

</form>


{% endif %}


{% endblock contenido_paciente %}